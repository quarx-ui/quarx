# Инструкция по использованию nvm в проекте

Для корректной работы с проектом нужна соответствующая версия **node.js**, которая указана в файле [.nvmrc](../.nvmrc).
Самый простой способ переключения версий ноды – использование утилиты [nvm](https://github.com/nvm-sh/nvm).

Существует 2 способа выбора версии `.nvmrc` – ручной выбор и автоматический.


## Ручной выбор версии

Чтобы выбрать корректную версию ноды, вы можете вручную выполнить следующую команду в терминале из корня проекта:
```shell
nvm use
```
После выполнения команды **nvm** автоматически прочитает файл `.nvmrc` и выберет необходимую версию ноды.
Если указанная версия ещё не установлена, то **nvm** выдаст ошибку и потребует предварительную установку этой версии.

В таком случае выполните последовательно команды:
```shell
nvm install
nvm use
```
После этого требуемая версия ноды будет установлена и активирована в терминале.


## Автоматический выбор версии

Автоматический выбор версии ноды будет основан на выполнении предварительного скрипта при запуске терминала.
Для активации этого скрипта потребуется использование **zsh**. Всё, что необходимо сделать, это добавить следующий
скрипт в конфигурацию `.zshrc`, после инициализаци **nvm**:
```shell
# nvm auto version
autoload -U add-zsh-hook
load-nvmrc() {
  local node_version="$(nvm version)"
  local nvmrc_path="$(nvm_find_nvmrc)"

  if [ -n "$nvmrc_path" ]; then
    local nvmrc_node_version=$(nvm version "$(cat "${nvmrc_path}")")

    if [ "$nvmrc_node_version" = "N/A" ]; then
      nvm install
    elif [ "$nvmrc_node_version" != "$node_version" ]; then
      nvm use
    fi
  elif [ "$node_version" != "$(nvm version default)" ]; then
    echo "Reverting to nvm default version"
    nvm use default
  fi
}
add-zsh-hook chpwd load-nvmrc
load-nvmrc
```
После добавления указанного выше скрипта, выбор версии nvm будет происходить при каждом запуске терминала на пк.
Если в проекте присутствует файл `.nnmrc`, то будет установлена и активирована версия из него. Если `.nvmrc` нет,
то будет выбрана стандартная версия ноды, которая указана в **nvm** как "default". 